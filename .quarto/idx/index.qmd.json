{"title":"Age Group Analysis","markdown":{"yaml":{"title":"Age Group Analysis","author":"Choo Jian Yuan","format":"html","editor":"visual"},"headingText":"Introduction","containsRefs":false,"markdown":"\n\n```{r}\n#| include: false\n#install.packages(\"writexl\")\ninstall.packages(\"echarts4r\", repos = \"https://cloud.r-project.org\")\ninstall.packages(\"cowplot\", repos = \"https://cloud.r-project.org\")\ninstall.packages(\"ggpubr\",repos = \"https://cloud.r-project.org\")\n\n#install.packages(\"plotly\", type = \"binary\")\nlibrary(\"skimr\")\nlibrary(\"tidyverse\")\nlibrary(\"kableExtra\")\nlibrary(\"dplyr\")\nlibrary(\"janitor\")\nlibrary(\"echarts4r\")\n#library(\"writexl\")\nsource(\"function.R\")\nlibrary(\"rlang\")\nlibrary(\"dplyr\")\nlibrary(\"echarts4r\")\nlibrary(\"plotly\")\nlibrary(\"cowplot\")\nlibrary(ggpubr)\n\n\nknitr::knit_child(\"Data2viewer.qmd\")\nknitr::knit_child(\"Data1viewer.qmd\")\n```\n\n```{=html}\n<style>\n\n.table-of-summary {\n  position: fixed;\n  bottom: 20px;\n  right: 0;\n  width: 50svh;\n  height: 95svh;\n  background-color: #ffffffee;\n  border: 1px solid #ccc;\n  padding: 1rem;\n  border-radius: 8px 0 0 8px;\n  box-shadow: 0 4px 8px rgba(0,0,0,0.1);\n  z-index: 999;\n  font-size: 0.9rem;\n  overflow-y: auto;\n  transform: translateX(100%);  /*Initially off screen */\n  transition: transform 0.3s ease-in-out;\n}\n\n.table-of-summary.show {\n  transform: translateX(0); /* Slide in */\n}\n\n#toggleButton {\n  position: fixed;\n  bottom: 30px;\n  right: 0;\n  z-index: 1000;\n  padding: 0.5rem 1rem;\n  border-radius: 8px 0 0 8px;\n  background-color: #007BFF;\n  color: white;\n  border: none;\n  cursor: pointer;\n}\n\nh4 {\n  color: Darkgreen;\n}\nhr {\n  background-color: Darkgreen;\n  border: 3px solid;\n}\n\n</style>\n```\n\n::: {#summaryPanel .table-of-summary}\n:::\n\n<button id=\"toggleButton\">\n\n☰\n\n</button>\n\n```{=html}\n<script>\ndocument.getElementById('toggleButton').addEventListener('click', function () {\n  document.querySelector('.table-of-summary').classList.toggle('show');\n});\n</script>\n```\n\n\nTitanic is one of the most famous love stories in film history, with a global box office revenue of USD 2.264 billion. Numerous scenes from the movie remain iconic and are still frequently discussed today. However, we cannot deny that it also portrays one of the most infamous shipwrecks in history, which claimed the lives of thousands and caused many families to lose their beloved members.\n\nThe raw dataset was obtained from Kaggle, an open-source data platform. Upon reviewing the dataset, data quality issues were identified in the Cabin, Age, SibSp, and Parch columns. I believe these issues are significant enough to potentially distort the accuracy of the analysis, based on several rounds of testing. As a result, this analysis will focus solely on **understanding the passenger structure** using the more reliable aspects of the data—specifically, **survival status, ticket class, embarkation point, and gender distribution.**\n\nThe analysis will be carried out base on following methods:\n\n```{r}\n#| echo: false\ndftest <- data.frame(\n  Name = c(\"R\",\"Excel\", \"Tableau Public\"),\n  link = c(\n    'N/A',\n    '<a href=\"\" target=\"_blank\">TBC</a>',\n    '<a href=\"public.tableau.com/profile/api/publish/Book1_17503194074060/Dashboard1\" target=\"_blank\">View</a>'),\n  stringsAsFactors = FALSE\n)\n\nkable(dftest,escape = FALSE)\n```\n\n## Body\n\n### Dataset Overview\n\n8`{r} merged(\"mdf\",data1,data2, \"passenger_id\") %>%    skim()`\n\n### Gender Distribution Overview\n\n```{r}\n#Distribution gender to total sample\nmdf %>% \n  drop_na() %>%\n  piechart_gg(.,sex,\"Attribute\",\"Passenger by Gender\") \n\n\n```\n\nThe pie chart above shows that the number of male passengers is approximately twice that of female passengers\n\n```{r}\n#| eval: false\n#| include: false\noutput <- mdf %>% \n        drop_na() %>% \n        mutate(age_group = cut(age,\n                               breaks = c(0,10,20,30,40,50,60,82),\n                               labels = c(),\n                               right = FALSE,\n                               Ordered_result = TRUE))\nwrite.csv(output, \"combined_set.csv\", row.names = FALSE)\n```\n\n### Gender Distribution to Each Age Group\n\n```{r}\n\n#Distribution gender to each age group\nalternate1 <- mdf %>% \n  drop_na() %>% \n  mutate(age_group = cut(age,\n                         breaks = c(0,10,20,30,40,50,60,82),\n                         labels = c(\"0-10\",\"10-20\",\"20-30\",\"30-40\",\"40-50\",\"50-60\",\"60+\"),\n                         right = FALSE,\n                         ordered_result = TRUE\n  )) \n\nalternate1 %>% \n  group_by(age_group,sex) %>%  #1st layer count base on age_group + sex\n  mutate(age_group_sex = n()) %>% \n  ungroup %>%\n  group_by(age_group) %>% \n  mutate(count_age_group =n()) %>% \n  ungroup %>% \n  select(sex, age_group,count_age_group, age_group_sex) %>% \n  unique() %>% \n  arrange(age_group)%>% \n  barchart_gg_custom(.,age_group,age_group_sex,sex)+\n  geom_text(aes(\n    label = \n      paste0(\n        age_group_sex,\n        \" (\",\n        round((age_group_sex/count_age_group)*100,0),\n        \"%)\"\n      )\n  ),\n    position = position_stack(0.5)\n  )+\n  labs(\n    title = \"Age Group distribution by Gender\",\n    x = \"Age Group\",\n    y = \"Gender\",\n    fill = \"Attribute\"\n  ) +\n  scale_y_continuous(expand=c(0,0),\n                     limits = c(0,150))\n  \n```\n\nThe graph above illustrates that males outnumber females across all age groups, **except in the 60+ category**, where females slightly surpass males. This trend may suggest that males generally held greater purchasing power during the observed period. Additionally, the **highest population concentration** falls within the **20–30 age group**, followed by the **30–40 group**, and so on. A detailed ranking is provided in the section below.\n\n#### Female Ranking by Age Group\n\n```{r}\n#| echo: false\n#Ranking large to small\nalternate1 %>% \n  filter(sex == \"female\") %>% \n  ranking_large_small(.,age_group,\"Female Passenger Ranking in Desc Order\") +\n        theme(legend.position =\"none\",\n            plot.title = element_text(hjust=-0.2,\n                                      margin=margin(l=40,b=30)\n            ))+\n  geom_text(\n    position = position_stack(vjust=0.8),\n    color = \"white\"\n  )+\n  scale_y_continuous(expand=c(0,0),\n                     limits=c(0,100))\n\n```\n\n#### Male Ranking by Age Group\n\n```{r}\n#| echo: false\n#Ranking large to small\nalternate1 %>% \n  filter(sex == \"male\") %>% \n  ranking_large_small(.,age_group,\"Ranking Male Passenger by Desc Order\") +\n        theme(legend.position =\"none\",\n            plot.title = element_text(hjust=-0.2,\n                                      margin=margin(l=20,b=30)\n            ))+  \n  geom_text(\n    position = position_stack(vjust=0.8),\n    color = \"white\"\n  )+\n  scale_y_continuous(expand=c(0,0),\n                     limits=c(0,100))\n\n```\n\n### Ticket Class by Gender\n\n```{r}\nmdf %>% \n  drop_na() %>% \n  group_by(pclass, sex) %>% \n  mutate(sex_count= n(),\n         pclas= as.character(pclass)) %>%\n  ungroup() %>% \n  group_by(pclass) %>% \n  mutate(pclass_count = n()) %>% \n  ungroup %>% \n  select(sex,sex_count, pclass, pclass_count) %>% \n  unique() %>%\n  barchart_gg_custom(.,pclass,sex_count,sex) +\n  labs(\n    title = \"Ticket Class distribution by Gender\",\n    x = \"Ticket Class\",\n    y = \"Count\",\n    fill = \"Attribute\"\n  )+\n  theme(\n    plot.title.position = \"plot\",\n    plot.title = element_text(margin = margin(b=20)),\n    axis.title.x = element_text(margin = margin(t=10))\n  )+\n  geom_text(\n    aes(\n      label = \n        paste0(\n          sex_count,\n          \" (\",\n          round((sex_count/pclass_count)*100,2),\n          \"%)\"\n        )\n    ),\n    position = position_stack(0.5)\n  ) +\n  scale_y_continuous(expand=c(0,0),\n                     limits = c(0,150))\n```\n\nThe graph above shows that third-class tickets had the highest number of passengers, followed by first class and then second class.\n\n### Ticket Class by Gender and Age Group\n\n```{r}\nalternate1 %>% \n  filter(sex ==\"male\") %>% \n  group_by(age_group, pclass) %>% \n  mutate(age_group_pclass = n()) %>% \n  select(age_group, pclass, age_group_pclass) %>% \n  unique() %>% \n  barchart_gg_custom(.,pclass, age_group_pclass,age_group)+\n  geom_text(\n    aes(\n      label = age_group_pclass,\n    ),\n    position = position_stack(0.5)\n  )+\n  labs(\n    title = \"Ticket Class distribution by Male and Age Group\",\n    x = \"Ticket Class\",\n    y = \"Count\",\n    fill = \"Attribute\"\n  )+\n  theme(\n    plot.title.position = \"plot\",\n    plot,title = element_text(margin = margin(b=20)),\n    axis.title.x = element_text(margin = margin(t=10))\n  )+\n  scale_y_continuous(expand=c(0,0),\n                     limits = c(0,100))\n\nalternate1 %>% \n  filter(sex ==\"female\") %>% \n  group_by(age_group, pclass) %>% \n  mutate(age_group_pclass = n()) %>% \n  select(age_group, pclass, age_group_pclass) %>% \n  unique() %>% \n  barchart_gg_custom(.,pclass, age_group_pclass,age_group)+\n  geom_text(\n    aes(\n      label = age_group_pclass,\n    ),\n    position = position_stack(0.5)\n  )+\n  labs(\n    title = \"Ticket Class distribution by Female and Age Group\",\n    x = \"Ticket Class\",\n    y = \"Count\",\n    fill = \"Attribute\"\n  )+\n  theme(\n    plot.title.position = \"plot\",\n    plot,title = element_text(margin = margin(b=20)),\n    axis.title.x = element_text(margin = margin(t=10))\n  )+\n  scale_y_continuous(expand=c(0,0),\n                     limits = c(0,60))\n\n```\n\n### Embarkation by Gender\n\n```{r}\n\n#C - embarked from Cherbourg\n#Q - embarked from Queenstown \n#S - embarked from Southampton.\n\nmdf %>% \n  drop_na() %>%\n  group_by(sex, embarked) %>% \n  mutate(sex_count = n()) %>%\n  ungroup() %>% \n  mutate(embarked = case_when(\n    embarked == \"C\" ~ \"Cherbourg\",\n    embarked == \"Q\" ~ \"Queenstown\",\n    embarked == \"S\" ~ \"Southampton\",\n         TRUE ~ embarked)\n  ) %>% \n  group_by(embarked) %>% \n  mutate(embarked_count = n()) %>% \n  ungroup %>% \n  select(sex, sex_count, embarked, embarked_count) %>% \n  unique() %>% \n  barchart_gg_custom(.,embarked, sex_count, sex) +\n  labs(\n    title = \"Embarkation by Gender\",\n    x = \"Location\",\n    y = \"Count\",\n    fill = \"Attribute\"\n  ) + \n  theme(\n    plot.title.position = \"plot\",\n    plot.title = element_text(margin = margin (b=20)),\n    axis.title.x = element_text(margin = margin (t=10))\n  )+\n  geom_text(\n    aes(\n      label = \n      paste0(\n        sex_count, \n        \" (\",\n        round((sex_count/embarked_count)*100,2),\n        \"%)\"\n        )\n      ),\n    position = position_stack(0.5)\n  )+\n  scale_y_continuous(expand = c(0,0),\n                     limits = c(0,250))\n\n  \n```\n\nThe graph above shows that the highest number of passengers embarked from Southampton, followed by Cherbourg, and lastly Queenstown\n\n### Survival Distribution\n\n```{r}\nmdf %>% \n  drop_na() %>% \n  mutate(\n    survived = case_when(\n      survived == \"S\" ~ \"Survived\",\n      survived == \"D\" ~ \"Deceased\",\n      TRUE ~ survived\n    )\n  ) %>% \n  piechart_gg(.,survived,\"Attribute\",\"Survival Distribution\")\n```\n\nThe graph above illustrates that the number of passengers who perished in the incident was approximately twice the number of those who survived. Further analysis, as shown in the illustration below, breaks the proportion of fatalities by gender.\n\n### Survived Distribution by Gender\n\n```{r}\nmdf %>%  \n  drop_na() %>% \n  group_by(survived, sex) %>% \n  mutate(survived_sex = n()) %>% \n  ungroup() %>% \n  group_by(survived) %>% \n  mutate(survived_count = n()) %>% \n  ungroup() %>% \n  select(sex, survived, survived_count, survived_sex) %>% \n  unique() %>% \n  ggplot(aes(\n    x= \"\",\n    y = survived_sex,\n    fill = sex\n  ))+\n    geom_col(width = 1)+\n    coord_polar(theta = \"y\")+\n    theme_void()+\n  labs(\n    title = \"Survival by Gender\",\n    fill = \"Attribute\"\n  )+\n  geom_text(\n    aes(\n      label = \n        paste0(\n          survived_sex,\n          \" (\",\n          (survived_sex/survived_count)*100,\n          \"%)\"\n        )\n    ),\n    position = position_stack(0.5)\n  )\n```\n\nThe graph above indicates that nearly all male passengers perished, whereas almost all female passengers survived.\n\n## Conclusion\n\nThe dataset above shows that the number of male passengers was approximately twice that of female passengers. This may reflect the societal structure during the Edwardian era, where women had limited access to employment opportunities and, consequently, lower purchasing power to afford a ticket on the Titanic.\n\nBased on embarkation data, it appears that residents from Southampton were relatively wealthier compared to those from Cherbourg and Queenstown, as the number of passengers from Southampton was nearly double the combined total from the other two locations.\n\nAdditionally, the distribution of ticket classes reveals an interesting pattern: third-class tickets had the highest concentration, followed by first class, and then second class. This may suggest that the middle class was not a dominant segment in the society at the time.\n\nLastly, the survivability rate presents a stark contrast between genders—100% of male passengers perished, while 100% of female passengers survived. This suggests that the survival pattern may have been influenced by deliberate planning, where men possibly sacrificed their lives to protect their family members.\n","srcMarkdownNoYaml":"\n\n```{r}\n#| include: false\n#install.packages(\"writexl\")\ninstall.packages(\"echarts4r\", repos = \"https://cloud.r-project.org\")\ninstall.packages(\"cowplot\", repos = \"https://cloud.r-project.org\")\ninstall.packages(\"ggpubr\",repos = \"https://cloud.r-project.org\")\n\n#install.packages(\"plotly\", type = \"binary\")\nlibrary(\"skimr\")\nlibrary(\"tidyverse\")\nlibrary(\"kableExtra\")\nlibrary(\"dplyr\")\nlibrary(\"janitor\")\nlibrary(\"echarts4r\")\n#library(\"writexl\")\nsource(\"function.R\")\nlibrary(\"rlang\")\nlibrary(\"dplyr\")\nlibrary(\"echarts4r\")\nlibrary(\"plotly\")\nlibrary(\"cowplot\")\nlibrary(ggpubr)\n\n\nknitr::knit_child(\"Data2viewer.qmd\")\nknitr::knit_child(\"Data1viewer.qmd\")\n```\n\n```{=html}\n<style>\n\n.table-of-summary {\n  position: fixed;\n  bottom: 20px;\n  right: 0;\n  width: 50svh;\n  height: 95svh;\n  background-color: #ffffffee;\n  border: 1px solid #ccc;\n  padding: 1rem;\n  border-radius: 8px 0 0 8px;\n  box-shadow: 0 4px 8px rgba(0,0,0,0.1);\n  z-index: 999;\n  font-size: 0.9rem;\n  overflow-y: auto;\n  transform: translateX(100%);  /*Initially off screen */\n  transition: transform 0.3s ease-in-out;\n}\n\n.table-of-summary.show {\n  transform: translateX(0); /* Slide in */\n}\n\n#toggleButton {\n  position: fixed;\n  bottom: 30px;\n  right: 0;\n  z-index: 1000;\n  padding: 0.5rem 1rem;\n  border-radius: 8px 0 0 8px;\n  background-color: #007BFF;\n  color: white;\n  border: none;\n  cursor: pointer;\n}\n\nh4 {\n  color: Darkgreen;\n}\nhr {\n  background-color: Darkgreen;\n  border: 3px solid;\n}\n\n</style>\n```\n\n::: {#summaryPanel .table-of-summary}\n:::\n\n<button id=\"toggleButton\">\n\n☰\n\n</button>\n\n```{=html}\n<script>\ndocument.getElementById('toggleButton').addEventListener('click', function () {\n  document.querySelector('.table-of-summary').classList.toggle('show');\n});\n</script>\n```\n\n## Introduction\n\nTitanic is one of the most famous love stories in film history, with a global box office revenue of USD 2.264 billion. Numerous scenes from the movie remain iconic and are still frequently discussed today. However, we cannot deny that it also portrays one of the most infamous shipwrecks in history, which claimed the lives of thousands and caused many families to lose their beloved members.\n\nThe raw dataset was obtained from Kaggle, an open-source data platform. Upon reviewing the dataset, data quality issues were identified in the Cabin, Age, SibSp, and Parch columns. I believe these issues are significant enough to potentially distort the accuracy of the analysis, based on several rounds of testing. As a result, this analysis will focus solely on **understanding the passenger structure** using the more reliable aspects of the data—specifically, **survival status, ticket class, embarkation point, and gender distribution.**\n\nThe analysis will be carried out base on following methods:\n\n```{r}\n#| echo: false\ndftest <- data.frame(\n  Name = c(\"R\",\"Excel\", \"Tableau Public\"),\n  link = c(\n    'N/A',\n    '<a href=\"\" target=\"_blank\">TBC</a>',\n    '<a href=\"public.tableau.com/profile/api/publish/Book1_17503194074060/Dashboard1\" target=\"_blank\">View</a>'),\n  stringsAsFactors = FALSE\n)\n\nkable(dftest,escape = FALSE)\n```\n\n## Body\n\n### Dataset Overview\n\n8`{r} merged(\"mdf\",data1,data2, \"passenger_id\") %>%    skim()`\n\n### Gender Distribution Overview\n\n```{r}\n#Distribution gender to total sample\nmdf %>% \n  drop_na() %>%\n  piechart_gg(.,sex,\"Attribute\",\"Passenger by Gender\") \n\n\n```\n\nThe pie chart above shows that the number of male passengers is approximately twice that of female passengers\n\n```{r}\n#| eval: false\n#| include: false\noutput <- mdf %>% \n        drop_na() %>% \n        mutate(age_group = cut(age,\n                               breaks = c(0,10,20,30,40,50,60,82),\n                               labels = c(),\n                               right = FALSE,\n                               Ordered_result = TRUE))\nwrite.csv(output, \"combined_set.csv\", row.names = FALSE)\n```\n\n### Gender Distribution to Each Age Group\n\n```{r}\n\n#Distribution gender to each age group\nalternate1 <- mdf %>% \n  drop_na() %>% \n  mutate(age_group = cut(age,\n                         breaks = c(0,10,20,30,40,50,60,82),\n                         labels = c(\"0-10\",\"10-20\",\"20-30\",\"30-40\",\"40-50\",\"50-60\",\"60+\"),\n                         right = FALSE,\n                         ordered_result = TRUE\n  )) \n\nalternate1 %>% \n  group_by(age_group,sex) %>%  #1st layer count base on age_group + sex\n  mutate(age_group_sex = n()) %>% \n  ungroup %>%\n  group_by(age_group) %>% \n  mutate(count_age_group =n()) %>% \n  ungroup %>% \n  select(sex, age_group,count_age_group, age_group_sex) %>% \n  unique() %>% \n  arrange(age_group)%>% \n  barchart_gg_custom(.,age_group,age_group_sex,sex)+\n  geom_text(aes(\n    label = \n      paste0(\n        age_group_sex,\n        \" (\",\n        round((age_group_sex/count_age_group)*100,0),\n        \"%)\"\n      )\n  ),\n    position = position_stack(0.5)\n  )+\n  labs(\n    title = \"Age Group distribution by Gender\",\n    x = \"Age Group\",\n    y = \"Gender\",\n    fill = \"Attribute\"\n  ) +\n  scale_y_continuous(expand=c(0,0),\n                     limits = c(0,150))\n  \n```\n\nThe graph above illustrates that males outnumber females across all age groups, **except in the 60+ category**, where females slightly surpass males. This trend may suggest that males generally held greater purchasing power during the observed period. Additionally, the **highest population concentration** falls within the **20–30 age group**, followed by the **30–40 group**, and so on. A detailed ranking is provided in the section below.\n\n#### Female Ranking by Age Group\n\n```{r}\n#| echo: false\n#Ranking large to small\nalternate1 %>% \n  filter(sex == \"female\") %>% \n  ranking_large_small(.,age_group,\"Female Passenger Ranking in Desc Order\") +\n        theme(legend.position =\"none\",\n            plot.title = element_text(hjust=-0.2,\n                                      margin=margin(l=40,b=30)\n            ))+\n  geom_text(\n    position = position_stack(vjust=0.8),\n    color = \"white\"\n  )+\n  scale_y_continuous(expand=c(0,0),\n                     limits=c(0,100))\n\n```\n\n#### Male Ranking by Age Group\n\n```{r}\n#| echo: false\n#Ranking large to small\nalternate1 %>% \n  filter(sex == \"male\") %>% \n  ranking_large_small(.,age_group,\"Ranking Male Passenger by Desc Order\") +\n        theme(legend.position =\"none\",\n            plot.title = element_text(hjust=-0.2,\n                                      margin=margin(l=20,b=30)\n            ))+  \n  geom_text(\n    position = position_stack(vjust=0.8),\n    color = \"white\"\n  )+\n  scale_y_continuous(expand=c(0,0),\n                     limits=c(0,100))\n\n```\n\n### Ticket Class by Gender\n\n```{r}\nmdf %>% \n  drop_na() %>% \n  group_by(pclass, sex) %>% \n  mutate(sex_count= n(),\n         pclas= as.character(pclass)) %>%\n  ungroup() %>% \n  group_by(pclass) %>% \n  mutate(pclass_count = n()) %>% \n  ungroup %>% \n  select(sex,sex_count, pclass, pclass_count) %>% \n  unique() %>%\n  barchart_gg_custom(.,pclass,sex_count,sex) +\n  labs(\n    title = \"Ticket Class distribution by Gender\",\n    x = \"Ticket Class\",\n    y = \"Count\",\n    fill = \"Attribute\"\n  )+\n  theme(\n    plot.title.position = \"plot\",\n    plot.title = element_text(margin = margin(b=20)),\n    axis.title.x = element_text(margin = margin(t=10))\n  )+\n  geom_text(\n    aes(\n      label = \n        paste0(\n          sex_count,\n          \" (\",\n          round((sex_count/pclass_count)*100,2),\n          \"%)\"\n        )\n    ),\n    position = position_stack(0.5)\n  ) +\n  scale_y_continuous(expand=c(0,0),\n                     limits = c(0,150))\n```\n\nThe graph above shows that third-class tickets had the highest number of passengers, followed by first class and then second class.\n\n### Ticket Class by Gender and Age Group\n\n```{r}\nalternate1 %>% \n  filter(sex ==\"male\") %>% \n  group_by(age_group, pclass) %>% \n  mutate(age_group_pclass = n()) %>% \n  select(age_group, pclass, age_group_pclass) %>% \n  unique() %>% \n  barchart_gg_custom(.,pclass, age_group_pclass,age_group)+\n  geom_text(\n    aes(\n      label = age_group_pclass,\n    ),\n    position = position_stack(0.5)\n  )+\n  labs(\n    title = \"Ticket Class distribution by Male and Age Group\",\n    x = \"Ticket Class\",\n    y = \"Count\",\n    fill = \"Attribute\"\n  )+\n  theme(\n    plot.title.position = \"plot\",\n    plot,title = element_text(margin = margin(b=20)),\n    axis.title.x = element_text(margin = margin(t=10))\n  )+\n  scale_y_continuous(expand=c(0,0),\n                     limits = c(0,100))\n\nalternate1 %>% \n  filter(sex ==\"female\") %>% \n  group_by(age_group, pclass) %>% \n  mutate(age_group_pclass = n()) %>% \n  select(age_group, pclass, age_group_pclass) %>% \n  unique() %>% \n  barchart_gg_custom(.,pclass, age_group_pclass,age_group)+\n  geom_text(\n    aes(\n      label = age_group_pclass,\n    ),\n    position = position_stack(0.5)\n  )+\n  labs(\n    title = \"Ticket Class distribution by Female and Age Group\",\n    x = \"Ticket Class\",\n    y = \"Count\",\n    fill = \"Attribute\"\n  )+\n  theme(\n    plot.title.position = \"plot\",\n    plot,title = element_text(margin = margin(b=20)),\n    axis.title.x = element_text(margin = margin(t=10))\n  )+\n  scale_y_continuous(expand=c(0,0),\n                     limits = c(0,60))\n\n```\n\n### Embarkation by Gender\n\n```{r}\n\n#C - embarked from Cherbourg\n#Q - embarked from Queenstown \n#S - embarked from Southampton.\n\nmdf %>% \n  drop_na() %>%\n  group_by(sex, embarked) %>% \n  mutate(sex_count = n()) %>%\n  ungroup() %>% \n  mutate(embarked = case_when(\n    embarked == \"C\" ~ \"Cherbourg\",\n    embarked == \"Q\" ~ \"Queenstown\",\n    embarked == \"S\" ~ \"Southampton\",\n         TRUE ~ embarked)\n  ) %>% \n  group_by(embarked) %>% \n  mutate(embarked_count = n()) %>% \n  ungroup %>% \n  select(sex, sex_count, embarked, embarked_count) %>% \n  unique() %>% \n  barchart_gg_custom(.,embarked, sex_count, sex) +\n  labs(\n    title = \"Embarkation by Gender\",\n    x = \"Location\",\n    y = \"Count\",\n    fill = \"Attribute\"\n  ) + \n  theme(\n    plot.title.position = \"plot\",\n    plot.title = element_text(margin = margin (b=20)),\n    axis.title.x = element_text(margin = margin (t=10))\n  )+\n  geom_text(\n    aes(\n      label = \n      paste0(\n        sex_count, \n        \" (\",\n        round((sex_count/embarked_count)*100,2),\n        \"%)\"\n        )\n      ),\n    position = position_stack(0.5)\n  )+\n  scale_y_continuous(expand = c(0,0),\n                     limits = c(0,250))\n\n  \n```\n\nThe graph above shows that the highest number of passengers embarked from Southampton, followed by Cherbourg, and lastly Queenstown\n\n### Survival Distribution\n\n```{r}\nmdf %>% \n  drop_na() %>% \n  mutate(\n    survived = case_when(\n      survived == \"S\" ~ \"Survived\",\n      survived == \"D\" ~ \"Deceased\",\n      TRUE ~ survived\n    )\n  ) %>% \n  piechart_gg(.,survived,\"Attribute\",\"Survival Distribution\")\n```\n\nThe graph above illustrates that the number of passengers who perished in the incident was approximately twice the number of those who survived. Further analysis, as shown in the illustration below, breaks the proportion of fatalities by gender.\n\n### Survived Distribution by Gender\n\n```{r}\nmdf %>%  \n  drop_na() %>% \n  group_by(survived, sex) %>% \n  mutate(survived_sex = n()) %>% \n  ungroup() %>% \n  group_by(survived) %>% \n  mutate(survived_count = n()) %>% \n  ungroup() %>% \n  select(sex, survived, survived_count, survived_sex) %>% \n  unique() %>% \n  ggplot(aes(\n    x= \"\",\n    y = survived_sex,\n    fill = sex\n  ))+\n    geom_col(width = 1)+\n    coord_polar(theta = \"y\")+\n    theme_void()+\n  labs(\n    title = \"Survival by Gender\",\n    fill = \"Attribute\"\n  )+\n  geom_text(\n    aes(\n      label = \n        paste0(\n          survived_sex,\n          \" (\",\n          (survived_sex/survived_count)*100,\n          \"%)\"\n        )\n    ),\n    position = position_stack(0.5)\n  )\n```\n\nThe graph above indicates that nearly all male passengers perished, whereas almost all female passengers survived.\n\n## Conclusion\n\nThe dataset above shows that the number of male passengers was approximately twice that of female passengers. This may reflect the societal structure during the Edwardian era, where women had limited access to employment opportunities and, consequently, lower purchasing power to afford a ticket on the Titanic.\n\nBased on embarkation data, it appears that residents from Southampton were relatively wealthier compared to those from Cherbourg and Queenstown, as the number of passengers from Southampton was nearly double the combined total from the other two locations.\n\nAdditionally, the distribution of ticket classes reveals an interesting pattern: third-class tickets had the highest concentration, followed by first class, and then second class. This may suggest that the middle class was not a dominant segment in the society at the time.\n\nLastly, the survivability rate presents a stark contrast between genders—100% of male passengers perished, while 100% of female passengers survived. This suggests that the survival pattern may have been influenced by deliberate planning, where men possibly sacrificed their lives to protect their family members.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.31","bibliography":["references.bib"],"editor":"visual","theme":["cosmo","brand"],"title":"Age Group Analysis","author":"Choo Jian Yuan"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"index.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":true,"bibliography":["references.bib"],"editor":"visual","documentclass":"scrreprt","title":"Age Group Analysis","author":"Choo Jian Yuan"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}